好 👍 我来帮你把 **问题 3** 的建模部分完整展开（目标函数、变量、约束、优化思路），并对应到你给的 **result1.xlsx** 模板字段。你只需要按这个模型写代码求解即可。

---

# 问题 3 建模

## 1. 决策变量

由于本题是 **FY1 投放 3 枚烟幕弹**，决策变量包含两类：

1. **无人机整体决策（固定一次）**

* 无人机运动方向（航向角 $\alpha \in [0,360^\circ)$）
* 无人机速度 $v_u$（70–140 m/s）

这两个变量在 3 枚烟幕弹中保持一致。

2. **每枚烟幕弹的个体决策（3 枚分别独立）**

* 投放时刻 $t_{r,i}$（第 $i$ 枚烟幕弹的释放时刻），要求相邻投放时间差 $\geq 1s$。
* 起爆延时 $\Delta_i$，因此起爆时刻 $t_{e,i} = t_{r,i} + \Delta_i$。
* 投放点坐标 $(x_{r,i},y_{r,i},z_{r,i})$ 与起爆点坐标 $(x_{e,i},y_{e,i},z_{e,i})$ 都由 UAV 飞行轨迹和弹体运动学决定，不是独立变量。

因此总体变量维度：

$$
x = (\alpha, v_u, \{t_{r,i}, \Delta_i\}_{i=1}^3)
$$

---

## 2. 运动学与几何关系

与问题 1/2 相同，只是扩展到三枚弹。

1. **无人机轨迹**

$$
U(t) = U_0 + v_u \hat u_u(\alpha)\, t,\quad \hat u_u(\alpha) = (\cos\alpha, \sin\alpha, 0)
$$

2. **第 i 枚烟幕弹投放点**

$$
S_i = U(t_{r,i})
$$

3. **起爆点（考虑重力下落）**

$$
C_{0,i} = S_i + v_u \hat u_u(\alpha)\,\Delta_i + \tfrac{1}{2}(0,0,-g)\Delta_i^2
$$

4. **云团运动**

$$
C_i(t) = C_{0,i} + (0,0,-v_{\text{sink}})(t - t_{e,i}),\quad t\in[t_{e,i},t_{e,i}+20]
$$

5. **遮蔽判定（与问题 1 相同）**
   对每个云团，定义导弹到目标线段与云团球体（半径 10 m）是否相交。
   判定函数：

$$
\chi_i(t)=1\ \text{if } \|C_i(t)-P(t)\|\le R,\quad 0\ \text{otherwise}
$$

其中 $P(t)$ 是导弹—目标线段上距 $C_i(t)$ 最近点。

---

## 3. 目标函数

* 对单个烟幕弹，第 $i$ 枚的有效遮蔽时长：

$$
T_{\text{shield},i} = \int_{t_{e,i}}^{t_{e,i}+20} \chi_i(t)\, dt
$$

* 对 3 枚烟幕弹的总遮蔽时长（需要考虑时间并集，不允许简单相加）

$$
T_{\text{shield,total}} = \int_{0}^{\infty} \mathbf{1}_{\bigcup_{i=1}^3 \{\chi_i(t)=1\}}\,dt
$$

也就是说，不同云团可能重叠遮蔽时段，重叠部分只算一次。

**优化目标**

$$
\max_x T_{\text{shield,total}}
$$

---

## 4. 约束条件

* UAV 速度范围： $70 \le v_u \le 140$
* 航向角： $\alpha \in [0,360^\circ)$
* 投放时间间隔： $t_{r,i+1} - t_{r,i} \ge 1$
* 起爆延时： $\Delta_i \ge 0$，可设上限（例如 20 s）
* 起爆点高度： $z_{e,i} \ge 0$（不能在地面以下）
* 投放/起爆必须在导弹到达目标之前发生

---

## 5. 求解策略

* **方法选择**：这是一个小维度（约 8–10 维）的非光滑优化问题，适合用 **全局优化算法**（如差分进化、CMA-ES、模拟退火）求解。
* **计算实现**：

  1. 给定 $(\alpha, v_u)$，计算 UAV 轨迹。
  2. 对每枚弹，确定 $S_i, C_{0,i}, t_{e,i}$。
  3. 在时间区间内采样，计算三枚烟幕弹的遮蔽函数 $\chi_i(t)$。
  4. 合并为 $\chi(t)=\max(\chi_1,\chi_2,\chi_3)$，积分得到总遮蔽时长。
* **得到结果**：选择最优参数集 $x^*$，输出三枚烟幕弹的投放点、起爆点、遮蔽时长。

---

## 6. 对应 result1.xlsx 输出字段

最终表格中，每一行对应一枚烟幕弹，字段填充方式如下：

* **无人机运动方向**：$\alpha$（角度，0–360，x轴正向逆时针为正）
* **无人机运动速度**：$v_u$（m/s）
* **烟幕干扰弹编号**：1, 2, 3
* **烟幕干扰弹投放点的(x,y,z)**：由 $S_i$ 计算得到
* **烟幕干扰弹起爆点的(x,y,z)**：由 $C_{0,i}$ 计算得到
* **有效干扰时长 (s)**：单枚遮蔽时长 $T_{\text{shield},i}$（注意这里是单枚弹的时长，不是并集）

👉 你在代码里再额外保存并集时长 $T_{\text{shield,total}}$，可以放在报告里说明。

---

✅ 总结：
问题 3 的模型就是 **在 UAV 固定速度与航向的前提下，联合优化 3 枚烟幕弹的投放时刻和起爆延时，使得总遮蔽时间最大化**。结果以每枚烟幕弹的投放点、起爆点、个体遮蔽时长填入 Excel。

---

要不要我帮你写一个 **数学公式化的并集遮蔽时长表达式（用 max/min 或集合并集形式展开）**，这样你在写论文报告时能更漂亮地展示？
