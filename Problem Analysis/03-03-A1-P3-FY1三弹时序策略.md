### 问题3：无人机FY1投放3枚烟幕弹对M1的最优干扰策略建模

#### 符号说明表

| 符号 | 含义 | 单位/约束 |
|------|------|-----------|
| $\theta$ | 无人机航向角 | $[0, 2\pi)$ rad |
| $v$ | 无人机速度 | $[70, 140]$ m/s |
| $t_{d_i}$ | 第i枚弹投放时间 | $t_{d_1} < t_{d_2}-1 < t_{d_3}-2$ s |
| $\tau_i$ | 第i枚弹投放起爆间隔 | $\tau_i \geq 0$ s |
| $P_{d_i}$ | 第i枚弹投放点 | m |
| $P_{b_i}$ | 第i枚弹起爆点 | m |
| $T_{\text{total}}$ | 总有效遮蔽时长 | s |
| $g$ | 重力加速度 | 9.8 m/s² |

#### 1. 导弹运动模型（M1）

初始位置：
$$M_0 = \begin{pmatrix} 20000 \\ 0 \\ 2000 \end{pmatrix}$$

速度向量：
$$\mathbf{v}_m = -300 \frac{M_0}{\|M_0\|} \approx \begin{pmatrix} -298.511 \\ 0 \\ -29.851 \end{pmatrix} \text{m/s}$$

位置函数：
$$M(t) = M_0 + \mathbf{v}_m t$$

#### 2. 无人机运动模型（FY1）

初始位置：
$$U_0 = \begin{pmatrix} 17800 \\ 0 \\ 1800 \end{pmatrix}$$

速度向量：
$$\mathbf{v}_u = \begin{pmatrix} v \cos \theta \\ v \sin \theta \\ 0 \end{pmatrix}$$

位置函数：
$$U(t) = U_0 + \mathbf{v}_u t$$

#### 3. 多烟幕弹模型（i=1,2,3）

**投放点**：
$$P_{d_i} = U(t_{d_i}) = \begin{pmatrix} 17800 + v \cos \theta \cdot t_{d_i} \\ v \sin \theta \cdot t_{d_i} \\ 1800 \end{pmatrix}$$

**弹道方程**：
$$P_{\text{弹}_i}(s) = P_{d_i} + \mathbf{v}_u s + \frac{1}{2} \begin{pmatrix} 0 \\ 0 \\ -g \end{pmatrix} s^2$$

**起爆点**：
$$P_{b_i} = P_{\text{弹}_i}(\tau_i) = \begin{pmatrix} 17800 + v \cos \theta (t_{d_i} + \tau_i) \\ v \sin \theta (t_{d_i} + \tau_i) \\ 1800 - \frac{1}{2} g \tau_i^2 \end{pmatrix}$$

**云团运动**：
$$C_i(t) = \begin{pmatrix} x_{b_i} \\ y_{b_i} \\ z_{b_i} - 3(t - t_{b_i}) \end{pmatrix}, \quad t \in [t_{b_i}, t_{b_i} + 20]$$
其中 $t_{b_i} = t_{d_i} + \tau_i$

#### 4. 多弹遮蔽条件模型

真目标位置：
$$T = \begin{pmatrix} 0 \\ 200 \\ 0 \end{pmatrix}$$

**联合遮蔽函数**：
$$\Phi(t) = \max_{i=1,2,3} \mathbf{1}_{\text{遮蔽}_i(t)}$$
其中 $\mathbf{1}_{\text{遮蔽}_i(t)}$ 为第i枚弹的遮蔽指示函数

**遮蔽条件**：
$$\mathbf{1}_{\text{遮蔽}_i(t)} = 
\begin{cases} 
1 & t \in [t_{b_i}, t_{b_i} + 20] \text{ and } d_i(t) \leq 10 \text{ and } 0 \leq u_i(t) \leq 1 \\
0 & \text{otherwise}
\end{cases}$$

点到线段距离计算：
$$d_i(t) = 
\begin{cases} 
\|\overrightarrow{AP_i}\| & u_i < 0 \\
\|P_i - B\| & u_i > 1 \\
\frac{\| \overrightarrow{AP_i} \times \overrightarrow{AB} \|}{\|\overrightarrow{AB}\|} & 0 \leq u_i \leq 1 
\end{cases}$$
$$u_i = \frac{\overrightarrow{AP_i} \cdot \overrightarrow{AB}}{\|\overrightarrow{AB}\|^2}$$

#### 5. 总遮蔽时长计算

$$T_{\text{total}}(\theta, v, \mathbf{t_d}, \mathbf{\tau}) = \int_{t_{\min}}^{t_{\max}} \Phi(t) dt$$
其中：
- $t_{\min} = \min(t_{b_i})$
- $t_{\max} = \min(\max(t_{b_i} + 20), 66.7)$
- $\mathbf{t_d} = [t_{d_1}, t_{d_2}, t_{d_3}]$
- $\mathbf{\tau} = [\tau_1, \tau_2, \tau_3]$

#### 6. 优化问题

**目标**：
$$\max_{\theta,v,\mathbf{t_d},\mathbf{\tau}} T_{\text{total}}$$

**约束**：
$$
\begin{cases}
\theta \in [0, 2\pi) \\
70 \leq v \leq 140 \\
t_{d_1} \geq 0 \\
t_{d_{i+1}} \geq t_{d_i} + 1 \quad (i=1,2) \\
\tau_i \geq 0 \\
z_{b_i} = 1800 - \frac{1}{2} g \tau_i^2 > 0 \\
t_{b_i} + 20 \leq 66.7
\end{cases}
$$

#### 7. 公式表

| 公式 | 表达式 | 说明 |
|------|--------|------|
| 1 | $M(t) = M_0 + \mathbf{v}_m t$ | 导弹位置 |
| 2 | $U(t) = U_0 + \mathbf{v}_u t$ | 无人机位置 |
| 3 | $P_{b_i} = f(\theta,v,t_{d_i},\tau_i)$ | 起爆点位置 |
| 4 | $C_i(t) = (x_{b_i}, y_{b_i}, z_{b_i} - 3(t-t_{b_i}))$ | 云团位置 |
| 5 | $u_i = \frac{\overrightarrow{AP_i} \cdot \overrightarrow{AB}}{\|\overrightarrow{AB}\|^2}$ | 投影参数 |
| 6 | $\Phi(t) = \max \mathbf{1}_{\text{遮蔽}_i}$ | 联合遮蔽函数 |
| 7 | $T_{\text{total}} = \int \Phi(t) dt$ | 总遮蔽时长 |

### 高效求解算法：自适应多阶段优化策略

针对高维优化问题（8个决策变量），采用多阶段混合优化框架：

#### 阶段1：全局探索（遗传算法）
- **编码**：实数编码 $[\theta, v, t_{d1}, \tau_1, t_{d2}, \tau_2, t_{d3}, \tau_3]$
- **种群大小**：100
- **适应度**：$T_{\text{total}}$
- **选择**：锦标赛选择
- **交叉**：模拟二进制交叉（SBX）
- **变异**：多项式变异
- **约束处理**：罚函数法

#### 阶段2：局部精细化（序列二次规划）
- 以遗传算法最优解为起点
- 采用SQP进行梯度优化
- 梯度计算：有限差分近似
- 处理非线性约束

#### 阶段3：时间协调优化（动态规划）
对固定$(\theta,v)$，求解最优投放序列：
```math
\begin{aligned}
&\max_{\mathbf{t_d},\mathbf{\tau}} T_{\text{total}} \\
&\text{s.t. } t_{d_{i+1}} \geq t_{d_i} + 1
\end{aligned}
```
- 状态变量：$(t_k, \text{最后投放时间})$
- 决策变量：$\Delta t$（投放间隔）
- 值函数：$V_k(t)$ = 剩余时间最大遮蔽

#### 阶段4：智能时间采样
遮蔽时间计算优化：
- 自适应时间窗口：仅在$[\min t_b, \max t_b+20]$采样
- 事件驱动采样：在遮蔽状态变化点加密采样
- 并行计算：三枚弹遮蔽计算并行化

### 关键优化技术

1. **变量降维**：
   - 航向角对称性：$\theta \equiv \theta + \pi$ 等价性
   - 时间关联性：$\tau_i = f(z_{\text{opt}})$ 高度优化

2. **约束优化**：
   - 投放时间链：$t_{d2} = t_{d1} + 1 + \delta_1$
   - 高度约束：$\tau_i < \sqrt{\frac{2 \times 1800}{g}} \approx 19.16$ s

3. **热启动策略**：
   使用问题2单弹最优解初始化：
   $$
   \begin{pmatrix} \theta^{(0)} \\ v^{(0)} \end{pmatrix} = \arg\max T_{\text{eff}}
   $$

### 计算流程

1. **初始化**：
   - 导弹轨迹预计算
   - 参数范围设定

2. **全局优化**：
   ```python
   best_solution = GA_optimizer(
       dim=8,
       bounds=[(0,2π), (70,140), (0,40), (0,19), (1,41), (0,19), (2,42), (0,19)],
       eval_func=compute_total_coverage,
       pop_size=100,
       max_gen=50
   )
   ```

3. **局部优化**：
   ```python
   refined_solution = SQP(
       initial=best_solution,
       constraints=[time_order, height_limit, total_time]
   )
   ```

4. **输出策略**：
   - 无人机参数：$\theta_{\text{opt}}, v_{\text{opt}}$
   - 弹1：$t_{d1}, \tau_1 \rightarrow P_{d1}, P_{b1}$
   - 弹2：$t_{d2}, \tau_2 \rightarrow P_{d2}, P_{b2}$
   - 弹3：$t_{d3}, \tau_3 \rightarrow P_{d3}, P_{b3}$

### 预期优化效果

1. **时间协同**：
   - 三枚弹形成接力遮蔽
   - 覆盖导弹不同飞行阶段

2. **空间协同**：
   - 沿导弹轨迹布置烟幕屏障
   - 不同高度层覆盖

3. **性能提升**：
   - 相比单弹，遮蔽时间提升200-300%
   - 最优解预期在25-35秒范围

此建模框架平衡了计算效率和解质量，通过多阶段优化策略有效处理高维决策空间，同时保证满足所有物理约束和任务要求。