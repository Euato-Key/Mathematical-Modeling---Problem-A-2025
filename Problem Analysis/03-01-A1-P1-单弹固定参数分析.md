### 问题1：烟幕干扰弹对M1的有效遮蔽时长建模

#### 符号说明表

| 符号 | 含义 | 单位/值 |
|------|------|---------|
| $t$ | 时间 | s |
| $M(t)$ | 导弹M1在t时刻的位置 | m |
| $\mathbf{v}_m$ | 导弹速度向量 | m/s |
| $U(t)$ | 无人机FY1在t时刻的位置 | m |
| $\mathbf{v}_u$ | 无人机速度向量 | m/s |
| $t_d$ | 烟幕弹投放时间 | 1.5 s |
| $t_b$ | 烟幕弹起爆时间 | 5.1 s |
| $P_{\text{弹}}(t)$ | 烟幕弹在t时刻的位置 | m |
| $C(t)$ | 烟幕云团中心在t时刻的位置 | m |
| $d(t)$ | 云团中心到线段MT的距离 | m |
| $R$ | 有效遮蔽半径 | 10 m |
| $g$ | 重力加速度 | 9.8 m/s² |
| $T_{\text{eff}}$ | 有效遮蔽时长 | s |

#### 1. 导弹运动模型

导弹M1初始位置：
$$M_0 = \begin{pmatrix} 20000 \\ 0 \\ 2000 \end{pmatrix}$$

导弹速度向量（指向原点(0,0,0)）：
$$\mathbf{v}_m = -300 \frac{M_0}{\|M_0\|} = -300 \frac{\begin{pmatrix} 20000 \\ 0 \\ 2000 \end{pmatrix}}{\sqrt{20000^2 + 2000^2}}$$

导弹位置函数：
$$M(t) = M_0 + \mathbf{v}_m t = \begin{pmatrix} 20000 \\ 0 \\ 2000 \end{pmatrix} + \begin{pmatrix} v_{mx} \\ 0 \\ v_{mz} \end{pmatrix} t$$

#### 2. 无人机运动模型

无人机FY1初始位置：
$$U_0 = \begin{pmatrix} 17800 \\ 0 \\ 1800 \end{pmatrix}$$

飞行方向朝向假目标(0,0,0)，但在xy平面内（等高度约束）：
$$\mathbf{v}_u = 120 \cdot \frac{\begin{pmatrix} -17800 \\ 0 \end{pmatrix}}{\|(-17800,0)\|} = \begin{pmatrix} -120 \\ 0 \\ 0 \end{pmatrix} \text{m/s}$$

无人机位置函数：
$$U(t) = \begin{pmatrix} 17800 \\ 0 \\ 1800 \end{pmatrix} + \begin{pmatrix} -120 \\ 0 \\ 0 \end{pmatrix} t$$

#### 3. 烟幕弹运动模型

投放时间：$t_d = 1.5$ s

投放位置：
$$P_d = U(t_d) = \begin{pmatrix} 17800 - 120 \times 1.5 \\ 0 \\ 1800 \end{pmatrix} = \begin{pmatrix} 17620 \\ 0 \\ 1800 \end{pmatrix}$$

烟幕弹运动方程（考虑重力加速度）：
$$P_{\text{弹}}(t) = \begin{pmatrix} 17620 \\ 0 \\ 1800 \end{pmatrix} + \begin{pmatrix} -120 \\ 0 \\ 0 \end{pmatrix} (t - 1.5) + \begin{pmatrix} 0 \\ 0 \\ -\frac{1}{2}g(t-1.5)^2 \end{pmatrix}$$

#### 4. 烟幕云团模型

起爆时间：$t_b = 5.1$ s

起爆位置：
$$P_b = P_{\text{弹}}(5.1) = \begin{pmatrix} 17188 \\ 0 \\ 1800 - \frac{1}{2} \times 9.8 \times (3.6)^2 \end{pmatrix} = \begin{pmatrix} 17188 \\ 0 \\ 1736.496 \end{pmatrix}$$

云团运动方程：
$$C(t) = \begin{pmatrix} 17188 \\ 0 \\ 1736.496 - 3(t - 5.1) \end{pmatrix}, \quad t \in [5.1, 25.1]$$

#### 5. 遮蔽条件建模

真目标位置：$T = (0, 200, 0)$

定义几何关系：
- $A = M(t)$（导弹位置）
- $B = T$（真目标位置）
- $P = C(t)$（云团中心位置）

计算向量：
$$\overrightarrow{AB} = B - A = \begin{pmatrix} -M_x(t) \\ 200 \\ -M_z(t) \end{pmatrix}$$
$$\overrightarrow{AP} = P - A = \begin{pmatrix} 17188 - M_x(t) \\ 0 \\ C_z(t) - M_z(t) \end{pmatrix}$$

投影参数：
$$u = \frac{\overrightarrow{AP} \cdot \overrightarrow{AB}}{\|\overrightarrow{AB}\|^2}$$

点到线段距离：
$$d(t) = 
\begin{cases} 
\|\overrightarrow{AP}\| & u < 0 \\
\|\overrightarrow{BP}\| & u > 1 \\
\frac{\|\overrightarrow{AP} \times \overrightarrow{AB}\|}{\|\overrightarrow{AB}\|} & 0 \leq u \leq 1 
\end{cases}$$

遮蔽条件：
$$\text{遮蔽有效} \iff 
\begin{cases} 
t \in [5.1, 25.1] \\
d(t) \leq 10 \\
0 \leq u \leq 1 
\end{cases}$$

#### 6. 遮蔽时长计算

有效遮蔽时长为满足遮蔽条件的时间区间长度：
$$T_{\text{eff}} = \int_{5.1}^{25.1} \mathbf{1}_{\text{遮蔽条件}} dt$$

#### 7. 公式表

| 公式编号 | 公式 | 说明 |
|---------|------|------|
| 1 | $M(t) = M_0 + \mathbf{v}_m t$ | 导弹位置 |
| 2 | $\mathbf{v}_m = -300 \frac{M_0}{\|M_0\|}$ | 导弹速度 |
| 3 | $U(t) = U_0 + \mathbf{v}_u t$ | 无人机位置 |
| 4 | $P_{\text{弹}}(t) = P_d + \mathbf{v}_u (t-t_d) + \frac{1}{2} \mathbf{g} (t-t_d)^2$ | 烟幕弹位置 |
| 5 | $C(t) = (x_b, y_b, z_b - 3(t-t_b))$ | 云团位置 |
| 6 | $u = \frac{\overrightarrow{AP} \cdot \overrightarrow{AB}}{\|\overrightarrow{AB}\|^2}$ | 投影参数 |
| 7 | $d(t) = \begin{cases} \|\overrightarrow{AP}\| & u<0 \\ \|\overrightarrow{BP}\| & u>1 \\ \frac{\|\overrightarrow{AP} \times \overrightarrow{AB}\|}{\|\overrightarrow{AB}\|} & 0\leq u\leq 1 \end{cases}$ | 点到线段距离 |
| 8 | $T_{\text{eff}} = \int_{t_b}^{t_b+20} \mathbf{1}_{\text{遮蔽条件}} dt$ | 有效遮蔽时长 |

### 求解方法

由于运动方程和几何关系的复杂性，解析解难以获得。采用数值方法求解：

1. **时间离散化**：在区间$[5.1, 25.1]$以步长$\Delta t=0.01$s采样
2. **位置计算**：对每个$t_i$
   - 计算导弹位置$M(t_i)$
   - 计算云团位置$C(t_i)$
3. **几何计算**：
   - 计算向量$\overrightarrow{AB}, \overrightarrow{AP}$
   - 计算$u$和$d(t_i)$
4. **遮蔽判定**：检查$d(t_i) \leq 10$和$0 \leq u \leq 1$
5. **时长计算**：统计满足条件的时间点数$N$，则
   $$T_{\text{eff}} = N \times \Delta t$$

### 关键参数计算

导弹速度分量：
- $\|M_0\| = \sqrt{20000^2 + 2000^2} = 2000\sqrt{101} \approx 20099.75$ m
- $v_{mx} = -300 \times 20000/20099.75 \approx -298.511$ m/s
- $v_{mz} = -300 \times 2000/20099.75 \approx -29.851$ m/s

烟幕弹起爆高度：
- $z_b = 1800 - \frac{1}{2} \times 9.8 \times (3.6)^2 = 1800 - 4.9 \times 12.96 = 1736.496$ m

通过这些计算，可得到烟幕干扰弹对M1的有效遮蔽时长。数值求解预计在10-15秒范围内，具体值需通过编程计算获得。