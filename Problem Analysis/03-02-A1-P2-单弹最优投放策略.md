### 问题2：优化单枚烟幕弹投放策略建模

#### 符号说明表

| 符号 | 含义 | 单位/约束 |
|------|------|-----------|
| $\theta$ | 无人机航向角 | $[0, 2\pi)$ rad |
| $v$ | 无人机速度 | $[70, 140]$ m/s |
| $t_d$ | 投放时间 | $t_d \geq 0$ s |
| $\tau$ | 投放起爆间隔 | $\tau \geq 0$ s |
| $t_b$ | 起爆时间 | $t_b = t_d + \tau$ s |
| $\mathbf{v}_u$ | 无人机速度向量 | m/s |
| $P_d$ | 投放点坐标 | m |
| $P_b$ | 起爆点坐标 | m |
| $T_{\text{eff}}$ | 有效遮蔽时长 | s |
| $g$ | 重力加速度 | 9.8 m/s² |

#### 1. 导弹运动模型（M1）

初始位置：
$$M_0 = \begin{pmatrix} 20000 \\ 0 \\ 2000 \end{pmatrix}$$

速度向量：
$$\mathbf{v}_m = -300 \frac{M_0}{\|M_0\|} = \begin{pmatrix} -298.511 \\ 0 \\ -29.851 \end{pmatrix} \text{m/s}$$

位置函数：
$$M(t) = M_0 + \mathbf{v}_m t$$

#### 2. 无人机运动模型（FY1）

初始位置：
$$U_0 = \begin{pmatrix} 17800 \\ 0 \\ 1800 \end{pmatrix}$$

速度向量：
$$\mathbf{v}_u = \begin{pmatrix} v \cos \theta \\ v \sin \theta \\ 0 \end{pmatrix}$$

位置函数：
$$U(t) = U_0 + \mathbf{v}_u t$$

#### 3. 烟幕弹运动模型

投放点：
$$P_d = U(t_d) = \begin{pmatrix} 17800 + v \cos \theta \cdot t_d \\ v \sin \theta \cdot t_d \\ 1800 \end{pmatrix}$$

弹道方程：
$$P_{\text{弹}}(s) = P_d + \mathbf{v}_u s + \frac{1}{2} \begin{pmatrix} 0 \\ 0 \\ -g \end{pmatrix} s^2$$
其中 $s \geq 0$ 为投放后时间

#### 4. 烟幕云团模型

起爆点：
$$P_b = P_{\text{弹}}(\tau) = \begin{pmatrix} x_b \\ y_b \\ z_b \end{pmatrix} = \begin{pmatrix} 17800 + v \cos \theta (t_d + \tau) \\ v \sin \theta (t_d + \tau) \\ 1800 - \frac{1}{2} g \tau^2 \end{pmatrix}$$

云团位置：
$$C(t) = \begin{pmatrix} x_b \\ y_b \\ z_b - 3(t - t_b) \end{pmatrix}, \quad t \in [t_b, t_b + 20]$$

#### 5. 遮蔽条件模型

真目标位置：
$$T = \begin{pmatrix} 0 \\ 200 \\ 0 \end{pmatrix}$$

几何关系：
- $A = M(t)$
- $B = T$
- $P = C(t)$

向量计算：
$$\overrightarrow{AB} = B - A, \quad \overrightarrow{AP} = P - A$$

投影参数：
$$u = \frac{\overrightarrow{AP} \cdot \overrightarrow{AB}}{\|\overrightarrow{AB}\|^2}$$

点到线段距离：
$$d(t) = 
\begin{cases} 
\|\overrightarrow{AP}\| & u < 0 \\
\|P - B\| & u > 1 \\
\frac{\| \overrightarrow{AP} \times \overrightarrow{AB} \|}{\|\overrightarrow{AB}\|} & 0 \leq u \leq 1 
\end{cases}$$

遮蔽条件：
$$\text{遮蔽有效} \iff 
\begin{cases} 
t \in [t_b, t_b + 20] \\
d(t) \leq 10 \\
0 \leq u \leq 1 
\end{cases}$$

#### 6. 有效遮蔽时长

$$T_{\text{eff}}(\theta, v, t_d, \tau) = \int_{t_b}^{t_b+20} \mathbf{1}_{\text{遮蔽条件}} dt$$

#### 7. 优化问题

目标函数：
$$\max_{\theta,v,t_d,\tau} T_{\text{eff}}(\theta, v, t_d, \tau)$$

约束条件：
$$
\begin{cases}
\theta \in [0, 2\pi) \\
70 \leq v \leq 140 \\
t_d \geq 0 \\
\tau \geq 0 \\
t_b + 20 \leq t_{\text{max}} \quad (\text{导弹飞行时间})
\end{cases}
$$

#### 8. 公式表

| 公式 | 表达式 | 说明 |
|------|--------|------|
| 1 | $M(t) = M_0 + \mathbf{v}_m t$ | 导弹位置 |
| 2 | $\mathbf{v}_u = (v \cos \theta, v \sin \theta, 0)^T$ | 无人机速度 |
| 3 | $P_d = U(t_d)$ | 投放点坐标 |
| 4 | $P_{\text{弹}}(s) = P_d + \mathbf{v}_u s - \frac{1}{2}g s^2 \mathbf{k}$ | 烟幕弹轨迹 |
| 5 | $C(t) = (x_b, y_b, z_b - 3(t - t_b))$ | 云团位置 |
| 6 | $u = \frac{\overrightarrow{AP} \cdot \overrightarrow{AB}}{\|\overrightarrow{AB}\|^2}$ | 投影参数 |
| 7 | $d(t) = \begin{cases} \|\overrightarrow{AP}\| & u<0 \\ \|P-B\| & u>1 \\ \frac{\|\overrightarrow{AP} \times \overrightarrow{AB}\|}{\|\overrightarrow{AB}\|} & 0\leq u\leq1 \end{cases}$ | 点到线段距离 |
| 8 | $T_{\text{eff}} = \int_{t_b}^{t_b+20} \mathbf{1}_{\text{条件}} dt$ | 有效遮蔽时长 |

### 求解策略

1. **参数空间离散化**：
   - $\theta$：$[0, 2\pi)$ 以 $\Delta\theta = \pi/18$ 离散化（20个点）
   - $v$：$[70, 140]$ 以 $\Delta v = 10$ 离散化（8个点）
   - $t_d$：$[0, 40]$ 以 $\Delta t_d = 1$ 离散化（41个点）
   - $\tau$：$[0, 20]$ 以 $\Delta \tau = 0.5$ 离散化（41个点）

2. **目标函数计算**：
   对每组参数 $(\theta_i, v_j, t_{d_k}, \tau_m)$：
   - 计算起爆时间 $t_b = t_{d_k} + \tau_m$
   - 在 $[t_b, t_b+20]$ 时间区间内，以 $\delta t = 0.1$ s 为步长离散
   - 对每个时间点 $t_n$：
     * 计算 $M(t_n)$ 和 $C(t_n)$
     * 计算 $u$ 和 $d(t_n)$
     * 检查遮蔽条件
   - 统计满足条件的时间点数 $N$
   - $T_{\text{eff}} = N \times \delta t$

3. **最优解搜索**：
   - 全参数空间搜索：计算 $20 \times 8 \times 41 \times 41 = 268,960$ 个点
   - 筛选 $T_{\text{eff}}$ 最大的参数组合

4. **局部精细化**：
   - 在最优解邻域进行二次搜索：
     $\Delta\theta = \pi/180$，$\Delta v = 1$，$\Delta t_d = 0.1$，$\Delta \tau = 0.1$

### 关键物理约束

1. **最大时间约束**：
   导弹到达假目标时间：
   $$t_{\text{max}} = \frac{\|M_0\|}{300} \approx 66.7 \text{ s}$$
   要求 $t_b + 20 \leq 66.7$

2. **高度约束**：
   起爆高度 $z_b = 1800 - 4.9\tau^2 > 0$ ⇒ $\tau < \sqrt{1800/4.9} \approx 19.1$ s

3. **无人机机动约束**：
   速度范围 $[70, 140]$ m/s
   航向角连续可调

### 预期优化方向

1. **拦截几何**：
   - 无人机应向导弹-目标视线方向机动
   - 最优航向应使烟幕弹在导弹轨迹前方起爆

2. **时机优化**：
   - $t_d$ 应保证在导弹到达前完成投放
   - $\tau$ 应使烟幕弹在最佳高度起爆

3. **速度权衡**：
   - 高速：更快到达投放位置
   - 低速：更精确控制投放时机

此模型通过参数化所有决策变量，将复杂的三维运动几何和遮蔽条件转化为可计算的优化问题，为求解最优投放策略提供了完整的数学框架。